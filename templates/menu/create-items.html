{% extends "base.html" %}
{% load static %}
{% block title %}Create Item{% endblock title %}

{% block content %}
<h2>Create Item</h2>
{% if message %}
    <div style="color: red; margin-bottom: 1em;">
        {{ message }}
    </div>
{% endif %}

<form method="post" action="{% url 'create_item' %}">
    {% csrf_token %}
    
    <label for="name">Item Name:</label>
    <input type="text" id="name" name="name" required><br><br>

    <div id="variants-container">
        <div class="variant">
            <label>Variant:</label>
            <input type="text" name="variant_name[]" required>

            <label>Price:</label>
            <input type="number" name="variant_price[]" step="0.01" required>

            <button type="button" class="remove-variant" onclick="removeVariant(this)">Remove</button>
        </div>
    </div>

    <button type="button" onclick="addVariant()">Add Variant</button><br><br>

    <button type="submit">Submit</button>
</form>
{% endblock content %}

{% block javascript %}
{{ block.super }}
<script>
    function addVariant() {
        const container = document.getElementById('variants-container');
        const div = document.createElement('div');
        div.classList.add('variant');
        div.innerHTML = `
            <label>Variant:</label>
            <input type="text" name="variant_name[]" required>

            <label>Price:</label>
            <input type="number" name="variant_price[]" step="0.01" required>

            <button type="button" class="remove-variant" onclick="removeVariant(this)">Remove</button>
        `;
        container.appendChild(div);
    }

    function removeVariant(button) {
    const container = document.getElementById('variants-container');
    if (container.children.length > 1) {
        button.parentElement.remove();
    } else {
        alert("At least one variant is required.");
        }
    }
</script>
{% endblock javascript %}

